"use strict";(()=>{var e={};e.id=300,e.ids=[300,888,660],e.modules={3630:(e,a,t)=>{t.r(a),t.d(a,{config:()=>j,default:()=>p,getServerSideProps:()=>f,getStaticPaths:()=>h,getStaticProps:()=>g,reportWebVitals:()=>v,routeModule:()=>w,unstable_getServerProps:()=>P,unstable_getServerSideProps:()=>_,unstable_getStaticParams:()=>N,unstable_getStaticPaths:()=>y,unstable_getStaticProps:()=>S});var s={};t.r(s),t.d(s,{default:()=>Agendar});var r=t(7093),l=t(5244),o=t(1323),n=t(6764),d=t(9467),i=t(997),c=t(6689),u=t(8165),x=t(3120),b=t(6398),m=t(8717);function Agendar(){let[e,a]=(0,c.useState)(1),[t,s]=(0,c.useState)(null),[r,l]=(0,c.useState)([]),[o,n]=(0,c.useState)(""),[d,p]=(0,c.useState)(""),[g,h]=(0,c.useState)(""),[f,j]=(0,c.useState)([]),[v,S]=(0,c.useState)(null),[y,N]=(0,c.useState)(""),[P,_]=(0,c.useState)(!1),handleSubmit=async()=>{try{if(_(!0),!t||!r.length||!o||!g){alert("⚠️ Por favor, preencha todos os campos obrigat\xf3rios"),_(!1);return}let e={userId:1,serviceId:r[0]?.id||1,date:t,time:"10:00",address:o,phone:g,price:calculateTotal(),notes:y},d=localStorage.getItem("token")||"demo-token",i=process.env.NEXT_PUBLIC_API_URL||"http://localhost:3001",c=await fetch(`${i}/api/bookings`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},body:JSON.stringify(e)});if(!c.ok){let e=await c.json();throw Error(e.error||"Falha ao agendar")}let u=await c.json();console.log("✅ Agendamento criado:",u),alert(`✅ Agendamento realizado com sucesso!
ID: ${u.booking?.id||"N/A"}`),s(null),l([]),n(""),h(""),p(""),N(""),a(1)}catch(e){console.error("❌ Erro ao processar agendamento:",e),alert(`❌ Erro: ${e.message||"Falha ao agendar. Tente novamente."}`)}finally{_(!1)}},calculateTotal=()=>r.reduce((e,a)=>e+(a.price||0),0);return(0,i.jsxs)("div",{className:"flex flex-col min-h-screen",children:[i.jsx(u.Z,{}),(0,i.jsxs)("main",{className:"flex-grow max-w-4xl mx-auto w-full px-4 py-8",children:[i.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Agendar Servi\xe7o de Limpeza"}),(0,i.jsxs)("div",{className:"mb-8",children:[i.jsx("div",{className:"flex justify-between items-center mb-4",children:[1,2,3,4].map(a=>i.jsx("div",{className:`flex-1 h-2 mx-1 rounded transition ${a<=e?"bg-blue-600":"bg-gray-300"}`},a))}),(0,i.jsxs)("p",{className:"text-center text-gray-600 font-semibold",children:["Passo ",e," de 4"]})]}),(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 mb-8",children:[1===e&&i.jsx(b.Z,{onDateSelected:s}),2===e&&i.jsx(m.Z,{onServiceSelected:l}),3===e&&(0,i.jsxs)("div",{children:[i.jsx("h3",{className:"text-xl font-bold mb-6",children:"Localiza\xe7\xe3o e Detalhes"}),(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{children:[i.jsx("label",{className:"block font-semibold mb-2",children:"Telefone *"}),i.jsx("input",{type:"tel",value:g,onChange:e=>h(e.target.value),placeholder:"(11) 9999-9999",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-600"})]}),(0,i.jsxs)("div",{children:[i.jsx("label",{className:"block font-semibold mb-2",children:"Endere\xe7o Completo *"}),i.jsx("input",{type:"text",value:o,onChange:e=>n(e.target.value),placeholder:"Rua, n\xfamero, complemento, bairro, cidade",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-600"})]}),(0,i.jsxs)("div",{children:[i.jsx("label",{className:"block font-semibold mb-2",children:"CEP"}),i.jsx("input",{type:"text",value:d,onChange:e=>p(e.target.value),placeholder:"00000-000",className:"w-48 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-600"})]}),(0,i.jsxs)("div",{children:[i.jsx("label",{className:"block font-semibold mb-2",children:"Notas Adicionais"}),i.jsx("textarea",{value:y,onChange:e=>N(e.target.value),placeholder:"Informa\xe7\xf5es adicionais sobre o servi\xe7o...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-600",rows:"4"})]})]})]}),4===e&&(0,i.jsxs)("div",{children:[i.jsx("h3",{className:"text-xl font-bold mb-6",children:"Resumo do Agendamento"}),(0,i.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg space-y-3",children:[(0,i.jsxs)("p",{children:[i.jsx("strong",{children:"Data:"})," ",t]}),(0,i.jsxs)("p",{children:[i.jsx("strong",{children:"Servi\xe7o:"})," ",r.map(e=>e.name).join(", ")]}),(0,i.jsxs)("p",{children:[i.jsx("strong",{children:"Endere\xe7o:"})," ",o]}),(0,i.jsxs)("p",{children:[i.jsx("strong",{children:"Telefone:"})," ",g]}),(0,i.jsxs)("p",{children:[i.jsx("strong",{children:"Total:"})," R$ ",calculateTotal().toFixed(2)]})]})]})]}),(0,i.jsxs)("div",{className:"flex justify-between gap-4 mb-8",children:[i.jsx("button",{onClick:()=>{e>1&&a(e-1)},disabled:1===e,className:"px-6 py-3 border border-gray-300 rounded-lg font-semibold disabled:opacity-50",children:"Voltar"}),e<4?i.jsx("button",{onClick:()=>{e<4&&a(e+1)},className:"px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700",children:"Pr\xf3ximo"}):i.jsx("button",{onClick:handleSubmit,disabled:P,className:"px-6 py-3 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 disabled:opacity-50",children:P?"⏳ Agendando...":"✅ Confirmar Agendamento"})]})]}),i.jsx(x.Z,{})]})}t(8281);let p=(0,o.l)(s,"default"),g=(0,o.l)(s,"getStaticProps"),h=(0,o.l)(s,"getStaticPaths"),f=(0,o.l)(s,"getServerSideProps"),j=(0,o.l)(s,"config"),v=(0,o.l)(s,"reportWebVitals"),S=(0,o.l)(s,"unstable_getStaticProps"),y=(0,o.l)(s,"unstable_getStaticPaths"),N=(0,o.l)(s,"unstable_getStaticParams"),P=(0,o.l)(s,"unstable_getServerProps"),_=(0,o.l)(s,"unstable_getServerSideProps"),w=new r.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/agendar-updated",pathname:"/agendar-updated",bundlePath:"",filename:""},components:{App:d.default,Document:n.default},userland:s})},5427:e=>{e.exports=require("@sentry/react")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},997:e=>{e.exports=require("react/jsx-runtime")},1017:e=>{e.exports=require("path")}};var a=require("../webpack-runtime.js");a.C(e);var __webpack_exec__=e=>a(a.s=e),t=a.X(0,[859,656,664,467,764,708,291],()=>__webpack_exec__(3630));module.exports=t})();